Todo:
- [ ] For Part1 Still need to do the 4th part of how to set the retain flag and the qos.